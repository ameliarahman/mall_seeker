<!DOCTYPE html>
<html>

<head>
  <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
    crossorigin="anonymous"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <meta charset="utf-8">
  <title></title>
</head>

<body>

  <button onclick="getLocation()">Try It</button>

  <div class="testHasil">
  </div>
</body>
<script>
  function getLocation() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(showPosition);
    }
  }
  function showPosition(position) {
    getNearby(position.coords.latitude, position.coords.longitude)
    // x.innerHTML = "Latitude: " + position.coords.latitude +
    // "<br>Longitude: " + position.coords.longitude;
  }

  function getNearby(lat, long) {
    let location = localStorage.getItem('location')
    location = JSON.parse(location)
    console.log('====================================');
    console.log(location);
    console.log('====================================');
    axios.get(`http://api-ext.trafi.com/routes?start_lat=${lat}&start_lng=${long}&end_lat=${location.lat}&end_lng=${location.lng}&is_arrival=false&api_key=b2fa03d2ac1f2f0e60bc39432760504a`)
      .then(function ({ data }) {
        console.log(data);
        data.Routes.forEach(function (route) {
          route.RouteSegments.forEach(function (segment) {
            $('.testHasil').append(`
              <div class="stop">
              duration minutes : ${route.DurationMinutes} <br>
              departure time : ${route.DepartureTime} <br>
              arrival time : ${route.ArrivalTime} <br>
              segment : ${segment.RouteSegmentType} <br>
              duration : ${segment.DurationMinutes} <br>
              distance : ${segment.WalkDistanceMeters} <br>
              end point : ${segment.EndPoint.Name}
              <br>
              <br>
              <br>
              </div>
              `)
          })
        })
      })
      .catch(function (error) {
        console.log(error)
      })
  }

</script>

</html>